document.addEventListener("DOMContentLoaded",function(e){setTimeout(()=>{const e=new URLSearchParams(window.location.search);var t=e.get("codes");t&&(document.getElementById("inputRpoCodes").value=decodeURIComponent(t),n(t))});let d=[];const i=e=>{var t=e=>e?"none":"";document.getElementById("emptyLabel").style.display=t(!0),document.getElementById("btnDecodePro").disabled=t(e),document.getElementById("progressBar").style.display=t(!e),document.getElementById("resultTable").style.display=t(e)};if(document.getElementById("btnCopyResult")?.addEventListener("click",function(){const t=document.getElementById("btnCopyResult");let n="Decoded by https://decoderpo.com/\n";d.map(e=>{n+=e.code+":\n",e.description.map(e=>{n+="    - "+e+"\n"}),n+="\n"});try{navigator.clipboard.writeText(n),t.innerHTML="Copied to Clipboard!"}catch(e){throw t.innerHTML="Error!",e}finally{setTimeout(function(){t.innerHTML="Copy Results"},3e3)}}),document.getElementById("btnShareResult")?.addEventListener("click",function(){const e=document.getElementById("btnShareResult");var t=window.location.href;navigator.clipboard.writeText(t).then(()=>e.innerHTML="Copied to Clipboard!").catch(()=>e.innerHTML="Error!").finally(()=>setTimeout(()=>e.innerHTML="Share Results",3e3))}),document.getElementById("RPOCodesForm")?.addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation();e=document.getElementById("inputRpoCodes").value;const t=new URL(window.location);t.searchParams.set("codes",e),window.history.pushState(null,"",t.toString()),n(e)}),document.getElementById("decodeByRpoRadio")?.addEventListener("change",e=>{document.getElementById("decodeByRpoForm").style.display="",document.getElementById("decodeByVinForm").style.display="none"}),document.getElementById("decodeByVinRadio")?.addEventListener("change",e=>{document.getElementById("decodeByRpoForm").style.display="none",document.getElementById("decodeByVinForm").style.display=""}),document.getElementById("decodeByVinForm")?.addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation();e=document.getElementById("inputVinCode").value;const t=new URL(window.location);t.searchParams.set("VIN",e),window.history.pushState(null,"",t.toString()),s(e)}),document.getElementById("RPOEncodeForm")){i(!0);let n=[];fetch("/static/rpoCodes.json").then(e=>e.json()).then(e=>{i(!1),n=e.allRpoCodes}),document.getElementById("RPOEncodeForm")?.addEventListener("submit",function(e){e.preventDefault(),i(!0);const o=document.getElementById("inputRpoCodes").value.toLowerCase().split(" ");let d=[],t="";console.time("test_timer"),n.map(e=>{let t=0;const n=e[1].toLowerCase();o.map(e=>{n.includes(e)&&t++}),0<t&&d.push({weight:t,content:"<tr><th>"+e[0]+'</th><td class="text-break">'+e[1]+"</td></tr>"})}),d.sort((e,t)=>e.weight>t.weight?-1:e.weight<t.weight?1:0).map(e=>{t+=e.content}),console.timeEnd("test_timer"),i(!1),document.getElementById("tableTbody").innerHTML=t})}document.getElementById("MoparVinCodeForm")&&document.getElementById("MoparVinCodeForm")?.addEventListener("submit",function(e){e.preventDefault(),i(!0);e=document.getElementById("inputMoparVinCode").value.toUpperCase();t()?(window.open("https://www.jeep.com/webselfservice/BuildSheetServlet?vin="+encodeURIComponent(e),"_blank").focus(),i(!1)):(document.getElementById("moparVinSearchResult").innerHTML=`
          <iframe width="100%" height="600px" src="https://www.jeep.com/webselfservice/BuildSheetServlet?vin=${encodeURIComponent(e)}">
          </iframe>
        `,setTimeout(()=>{i(!1)},2e3))}),document.getElementById("GmVinCodeForm")&&document.getElementById("GmVinCodeForm")?.addEventListener("submit",function(e){e.preventDefault(),i(!0);e=document.getElementById("inputGmVinCode").value.toUpperCase();t()?(window.open("https://cws.gm.com/vs-cws/vehshop/v2/vehicle/windowsticker?vin="+encodeURIComponent(e),"_blank").focus(),i(!1)):(document.getElementById("gmVinSearchResult").innerHTML=`
          <iframe width="100%" height="600px" src="https://cws.gm.com/vs-cws/vehshop/v2/vehicle/windowsticker?vin=${encodeURIComponent(e)}">
          </iframe>
        `,setTimeout(()=>{i(!1)},2e3))});const n=e=>{i(!0);const t=e.split(" ").reduce((e,t)=>e.concat(t.split(",")),[]).reduce((e,t)=>e.concat(t.split("-")),[]).map(e=>e.replace(/\s+/g,"").replace(",","").toUpperCase()).filter(e=>0<e.length);e=t.map(e=>fetch("/api/getRPODescription/"+e));Promise.all(e).then(e=>{Promise.all(e.map(t=>{if(200===t.status)return t.json();try{let e=new URL(t.url);var n=e.pathname.slice(1).split("/").slice(-1)[0];fetch("/api/reportRpoNotFound/"+n)}catch(e){console.error(e)}return["Not found"]})).then(e=>{i(!1),e=e.map(e=>"Not found"===e[0]?e:JSON.parse(atob(e[0]))),o(t,e)}).catch(e=>{console.error(e)})}).catch(e=>{console.error(e)})},o=(e,n)=>{d=1===e.length&&17===e[0].length?[{code:e[0],description:["Error: you entered VIN instead of RPO Code."]}]:e.map((e,t)=>3<e.length?{code:e,description:["Wrong format: RPO code should contains 3 chars"]}:{code:e,description:n[t]});let o="";d.map(e=>{var t='<ul class="list-unstyled">'+e.description.reduce((e,t)=>e+`<li>${t}</li>`)+"</ul>";o+="<tr><th>"+encodeURIComponent(e.code)+'</th><td class="text-break">'+t+"</td></tr>"}),document.getElementById("tableTbody").innerHTML=o},s=s=>{i(!0),fetch("https://decoderpo.com/api/getVinDecode/"+s).then(e=>{if(404===e.status)throw new Error("VIN not found.");return e.json()}).then(e=>{i(!1);const t=[{code:"",description:e.vehicleInfo},{code:"",description:s},{code:"",description:e.optionalInfo}];e.specification.map(e=>{"-"===e.desc[3]&&(e=e.desc.split(/-(.*)/s),t.push({code:e[0],description:e[1]}))}),n(t),console.log(e)}).catch(e=>{i(!1),console.log(e),n([{code:"",description:e.message}])});const n=n=>{let o="";n.map((e,t)=>{7===t&&(o+='<tr><th></th><td class="text-break" style="text-align: center;"><b style="font-weight: 900;">Buy a full report for $4.99 to see all '+n.length+' RPO codes<b></td></tr><tr><th></th><td class="text-break"  style="text-align: center;"><button type="submit" class="btn btn-success mb-3" id="btnBuyReport">BUY FULL REPORT FOR $4.99</button></td></tr>'),o+='<tr><th><div class="maskedInfoBeforBuy">'+encodeURIComponent(e.code.length<3||t<7?e.code:"*"+e.code[1]+e.code[2])+'</div><div class="fullInfoBeforBuy" style="display: none">'+encodeURIComponent(e.code)+'</div></th><td class="text-break"><div class="maskedInfoBeforBuy">'+(e.description.length<10||t<7?e.description:e.description.slice(0,10)+"*".repeat(e.description.length-10))+'</div><div class="fullInfoBeforBuy" style="display: none">'+e.description+"</div></td></tr>"}),document.getElementById("tableTbody").innerHTML=o,document.getElementById("btnBuyReport")?.addEventListener("click",e=>{var t=document.getElementsByClassName("maskedInfoBeforBuy"),n=document.getElementsByClassName("fullInfoBeforBuy");for(const o of t)o.style.display="none";for(const d of n)d.style.display="";fetch("/api/reportbuyfullreport/"+s)})}};function t(){return/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}});